---
title: "API Key Integrations"
description: "Deploy and use API key-based integrations with Metorial"
---

API key integrations use a single credential shared across your entire application. These are ideal for services that don't require user-specific authorization—like search APIs (Exa, Tavily) or data providers where one API key serves all your users.

<Note>
  **In this guide:**
  - Deploy an API key integration in minutes
  - Use integrations in your AI agents
  - Understand when to use API keys vs OAuth

  **Prerequisites:**
  - Metorial account and API key
  - API key from your integration provider
</Note>

## When to Use API Key Integrations

Use API key integrations when:
- The service doesn't need user-specific data (search APIs, weather APIs)
- You're building internal tools where one credential is sufficient
- The API doesn't support OAuth or user authorization

For user-specific data (Gmail, GitHub, Slack), use [OAuth integrations](integrations-oauth) instead.

## Quick Start

<Steps>
  <Step title="Get Your API Key">
    Sign up for your integration provider (e.g., Exa, Tavily) and generate an API key from their dashboard.
  </Step>

  <Step title="Deploy in Metorial">
    Navigate to **Servers** → Search for your integration → Click **Deploy**

    Provide:
    - Deployment name (e.g., "Production Exa")
    - Your API key
  </Step>

  <Step title="Test the Deployment">
    Use the built-in test console to verify the integration works correctly.
  </Step>

  <Step title="Copy Deployment ID">
    Save the deployment ID (e.g., `svd_abc123`) - you'll need this in your code.
  </Step>
</Steps>

## Using API Key Integrations

Once deployed, reference your integration by its deployment ID. Metorial handles authentication automatically using the configured API key.

<CodeGroup>

```typescript TypeScript
import { Metorial } from 'metorial';
import { metorialAiSdk } from '@metorial/ai-sdk';
import { anthropic } from '@ai-sdk/anthropic';
import { streamText } from 'ai';

const metorial = new Metorial({
    apiKey: process.env.METORIAL_API_KEY
});

async function searchWithExa() {
    await metorial.withProviderSession(
        metorialAiSdk,
        {
            serverDeployments: [
                { serverDeploymentId: 'svd_your_exa_deployment' }
            ],
            streaming: true
        },
        async ({ tools, closeSession }) => {
            const result = streamText({
                model: anthropic('claude-sonnet-4-5'),
                prompt: 'Search for the latest AI research papers',
                tools: tools,
                onFinish: async () => await closeSession()
            });

            for await (const text of result.textStream) {
                process.stdout.write(text);
            }
        }
    );
}

searchWithExa();
```

```python Python
from metorial import Metorial
from anthropic import AsyncAnthropic
import asyncio
import os

metorial = Metorial(api_key=os.getenv("METORIAL_API_KEY"))
anthropic = AsyncAnthropic(api_key=os.getenv("ANTHROPIC_API_KEY"))

async def search_with_exa():
    async with metorial.provider_session(
        provider="anthropic",
        server_deployments=[
            {
                "serverDeploymentId": "svd_your_exa_deployment"
            }
        ],
    ) as session:
        # Initial request
        response = await anthropic.messages.create(
            model="claude-sonnet-4-20250514",
            max_tokens=2048,
            tools=session.tools,
            messages=[{
                "role": "user",
                "content": "Search for the latest AI research papers"
            }],
        )

        # Handle tool calls in agentic loop
        while response.stop_reason == "tool_use":
            tool_calls = [b for b in response.content if b.type == "tool_use"]

            # Execute tools via Metorial
            tool_results = await session.call_tools(tool_calls)

            # Continue conversation with results
            messages.append({"role": "assistant", "content": response.content})
            messages.append({
                "role": "user",
                "content": [
                    {
                        "type": "tool_result",
                        "tool_use_id": tool_calls[i].id,
                        "content": str(result)
                    }
                    for i, result in enumerate(tool_results)
                ]
            })

            response = await anthropic.messages.create(
                model="claude-sonnet-4-20250514",
                max_tokens=2048,
                tools=session.tools,
                messages=messages,
            )

        # Get final response
        final_text = " ".join(
            block.text for block in response.content if block.type == "text"
        )
        print(final_text)

asyncio.run(search_with_exa())
```

</CodeGroup>

## Using Multiple Integrations

You can use multiple API key integrations in a single session:

```typescript
await metorial.withProviderSession(
    metorialAiSdk,
    {
        serverDeployments: [
            { serverDeploymentId: 'svd_exa_deployment' },
            { serverDeploymentId: 'svd_tavily_deployment' },
            { serverDeploymentId: 'svd_weather_api' }
        ],
        streaming: true
    },
    async ({ tools, closeSession }) => {
        // AI can now use all three integrations
        const result = streamText({
            model: anthropic('claude-sonnet-4-5'),
            prompt: 'Search for AI news and get weather in SF',
            tools: tools,
            onFinish: async () => await closeSession()
        });

        for await (const text of result.textStream) {
            process.stdout.write(text);
        }
    }
);
```

## Managing API Keys

### Rotating Keys

To rotate an API key:
1. Generate a new key from your provider
2. Update the deployment in Metorial
3. The change takes effect immediately—no code changes needed

### Environment-Specific Deployments

Create separate deployments for different environments:
- `Production Exa` - for production use
- `Development Exa` - for testing
- `Staging Exa` - for staging environment

Use environment variables to switch between them:

```typescript
const deploymentId = process.env.NODE_ENV === 'production'
    ? 'svd_prod_deployment'
    : 'svd_dev_deployment';
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="Integration tools not appearing">
    Verify the deployment ID is correct and the deployment is active in the Metorial dashboard.
  </Accordion>

  <Accordion title="Authentication errors">
    Check that your API key is valid and has the necessary permissions. Test the integration in the Metorial console.
  </Accordion>

  <Accordion title="Rate limiting">
    API key integrations share rate limits across all users. Consider implementing request queuing or using multiple deployments with different keys.
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="OAuth Integrations" icon="shield" href="integrations-oauth">
    Set up user-authorized integrations for personalized data access
  </Card>
  <Card title="Build an Agent" icon="robot" href="sdk-quickstart">
    Build your first AI agent with Metorial integrations
  </Card>
  <Card title="Available Integrations" icon="grid" href="integrations-overview">
    Browse all available Metorial integrations
  </Card>
  <Card title="MCP Servers" icon="server" href="mcp-servers">
    Learn about the MCP protocol powering integrations
  </Card>
</CardGroup>
